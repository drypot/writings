# JUnit

2010.07.25

일주일 동안 클래스 70 개 만들었는데,
Run 을 한 번도 안 해서, =,=

JUnit TestCase 만들어 부분 부분 돌려보고 있는데,
우왕 굿. 재미남. ㅋ

오래된 사람이라 유닛 테스트 쓸 생각을 안 했었는데,
나도 이제 TDD 유저. =O=

근데 어디선가 TDD 안 좋은 글들 지나가는거 본거 같은데,
이거도 하다 보면 단점들 막 나오는 거 아닌가. =,=

그리고 왠지 느낌에 저 뒤에 클래스 디자인
Test 할 수 있게 많이 바까야 할 것 같은. =o=

2010.07.26

생각보다 편하다.

엔터페이스쪽으로 갈 수록 테스트 골 때릴 것 같고,
걍 라이브러리, 로직 확인하는데는 쟁땅인듯.

2010.07.29

이 책 저 책 살펴보다가 전 그냥 암 생각 없이 '테스트 주도 개발 TDD 실천법과 도구' 이 책 사서 봤는데
마음에 들어서 쭉 다 읽었습니다.
현장 경험이 풍부한 것 같았고요, 도움 많이 되었습니다.
좋은 책 같습니다.

결론은, Java 에서는 JUnit + Mockito
Mockito 같은 것은 상상도 못했는데 저렇게도 되는군요.

나머지 DB 관련 유틸이나 햄크레스트 같은 DSL 은 안 쓰려고 합니다.
걍 아는 걸로 + 쌩 코드로 때울 생각. ^^

HttpServletRequest Mock 이 필요한데,
책에서는 스프링에서 주는 Mock 을 쓰던데,
스프링을 안 쓰니,,,

2010.08.06

Unit Test 진짜 좋은거 같애... =o=

2010.08.07

해 봐, 새로운 세상.

딱 그거임,
코드 테스트를 내가 직접 눈으로 안 하고, 프로그램이 해줌.
먼가 고친 후에 눈으로 확인하려면 시간 오래 걸리고, 시스템 전체 사이드 이펙트 테스트 못하는데,
유닛테스트는 얼렁 끝나기 때문에,,, 걍 꾹꾹 누르는 거임, 녹색 나올 때까지.
어디선가 X 뜨면 냅다 클릭해서 확인.

먼가 클래스 내부 로직 고치고 싶으면,
수정하면스 틈틈히 유닛테스트 꾹꾹,
녹색 나오면 계속,
X 뜨면 버그 수정.

먼가 고치고 테스트 대충하고 넘어갔다가 천년 후에 버그가 발견되면
몰 고치다 그랬는지 까먹어서 원인 찾는데 몇 시간 헤딩하는데,
유닛테스트 조건이 유용하다는 조건하에,
고치면서 계속 유닛테스트 돌리면 최근 5~10 분 사이 작업한 부분에서 문제가 있다는 것이 들어나므로,
천년 후에 발견될 버그를 바로 찾을 수 있다는 장점.

테스트 케이스 만드는데 시간은 걸리는데,
설정한 모든 극한 조건 다 통과하면,
매우 마음이 놓임. ^^

처음부터 TDD 하지 않더라도,
일단 만들어 놓은 것을 재미삼아 테스트 케이스 만들어 돌려보면,
딱 감이 오고,
앞으로 수정하는 부분에 대해서 테스트 케이스 만들어 가면서 점진적으로 적응하면 될 듯.

문제는 근데,
아마도 90% 확률로,
지금 만들어 놓은 클래스들이 강결합이 많아서 테스트하기 만만치 않을 꺼임.
이거 자르는 것이 일인데,
이거 자르면서 많은 깨달음이 몰려옴. ^^
슬슬 자르기 시작하면 클래스들 관계가 명료해지고, 코드가 깔끔해지고,
기분이 좋아짐.

더불어 간접 효과로,
로직 테스트는 웹 컨테이너 안 통하고 JUnit 에서 끝나니까,
웹 쪽 개발에서는 모하나 고치면서 Tomcat 죽였다 살렸다 할 일이 대폭 줄어듬.

웹 요청 들어오면 돌아가는 부분 테스트하려면,
예전 같으면 웹 서버 띄우고, 직접 브라우저에 값 넣고, 서밋하고, 콘솔 결과보고 그래야 했는데,

스프링에서 Http Mock 들 만든거 가져다 쓰면,
여기다 들어올 값들 쭉 넣고, 로직에 날리면,
브라우저에서 쏜 것처럼 보이니까,
먼가 로직에 문제 있는 건 브라우저, 웹 서버 안 통하고 JUnit 으로 확인할 수 있음.

2010.08.07

내가 처음 유닛테스트 하는 거 동영상으로 본 게 2 년전인데,
M$ 에서 왠 엔지니어가 나와서 먼가 라이브러리 시연하는데 계속 빨간 막대, 녹색 막대만 왔다갔다하고, =,=
'자 다 녹색이죠? 다~ 됐어요~' 하길레
저 인간 뭐하나,
저거 미친거 아닌가 싶었는데, =,=
내가 그러고 있음.

2010.08.09

유닛 테스트는 먼가 새로 생기는 건 아니고,
프로그램 개발하면서 일상적으로 테스트 런 시키고 사람이 일일이 눈으로 확인하던 것을 걍 프로그램화 시킨 것임.
난 거부감 거의 없었고, 되려 매우 편했음.

딱 이것임.

루틴 만들고 결과가 10 인 것을 확인하려면 아래 한줄 넣고 런해보지 않음?
System.out.println(result);

그리고 콘솔에 결과가 10 인 것을 확인하겠지?

10 이면 잘 되었으니 넘어갔다가, System.out .. 이부분 코멘트 아웃시키고.
나중에 다시 와서 먼가 고쳤으면 다시 결과 를 확인하려고 System.out... 코멘트 지우고 돌려보겠지?

프로그램 개발할 때 일상적으로 결과를 확인함.

Unit Test 는 걍 이걸 자동화시킨거임.

assertEquals(10, myFunc());

이렇게 주제 클래스가 아닌 다른 테스트 케이스에 적어 놓고,
필요할 때만 테스트 케이스 런해보는거임.
그러면 JUnit 이 결과가 10 인지 확인해줌. 내 대신에.

Unit Test 쓰는 단계에서 먼가 달라지는 건 없음.

단,

여기서 한발 더 나아가서,
작업 프로세스가 주제 클래스 작성 -> 테스트 케이스 작성에서,
테스트 케이스 작성 -> 주제 클래스 작성으로 넘어갈 수도 있는데,
내가 보기에 이클립스 자동화 도구를 여기에 쓸 건지 저기에 쓸건지 정도 차이 밖에 안 되는 거 같음. =,=

예전 방식으로 클래스 쫙 만들고 테스트 하고 싶으면 그리 해도 됨.
주제 클래스에서 JUnit  Test Gen 시키면 알아서 테스트 스텁 쫙 만들어 줌.

반대로 TDD 한다면 JUnit Test 클래스 작성하면,
당연히 주제 클래스가 없으니 빨간 밑줄 그어지는데,
걍 그 위에서 Ctrl-1 해서 Fix 하면 이클립스에서 주제 클래스 자동으로 만들어 줌. 메서드까지.
그럼 F3 눌러서 거기가서 코드 넣는거고.

그닌까 요컨데, 별로 달라지는 건 없음.
단지 프로세스가 좀 빨라지고,
테스트 런이 편해지니 틈틈히 자주 확인하게 되는 것 같음.

아 근데, 많이 달라지는 건,
클래스나 메서드를 테스트 쉽게 하게 만들게 됨.
이건 매우 좋은 습관이라고 봄.
주제 클래스 간의 관계도 매우 명확해짐.
사실 TDD 는 이거 때문에 라도 해야한다고 생각.

내가 만든 클래스를 테스트 하려들 때
내가 그간 얼마나 개차반으로 클래스 만들었는지 뼈저리게 반성이 옴. ㅋㅋ

음, 꼭 전체를 TDD 안 해도,
이런 경우도 매우 좋음.

테스트 케이스 없이 이미 돌아가는 시스템이 있을 때, (슬릭 같은 경우도 딱 그꼴)
모듈 중간을 뜬금없이 수정해야 함.

테스트 생각 없이 만들어 놓은 프로그램은 시스템 중간 수정한 후에 거기만 테스트 하려면 황당해짐.
전체 시스템 런해봐야 하는 경우가 태반.
웹 어플이라면 톰켓 부터 띄우고, =,=

테스트하기 편하게 만들어 두면,
딱 고친 부분만 JUnit 으로 Run 해 볼 수 있음.
이거 진짜 편한거임. ^^

일단 필요한 부분부터 테스트 케이스 쓸 수 있도록 고쳐나가면 될 듯.
오늘 만든 함수라든가,,,

TDD 가 매우 실용적인 스킬이라 먼가 거창한 것이 없음.
책 조금 읽고 오늘 당장 시작할 수 있음. 오늘 작업한 분량부터.
그럼 감이 오면서,
이전에 만들어 놓은 클래스 막 수정하고 싶을 꺼임.
